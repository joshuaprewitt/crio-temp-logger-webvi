"use strict";function _classCallCheck(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,i){for(var t=0;t<i.length;t++){var a=i[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(i,t,a){return t&&e(i.prototype,t),a&&e(i,a),i}}();JQX.Utilities.Assign("TickIntervalHandler",function(){function e(i,t,a,n,r,l,s){_classCallCheck(this,e);var o=this;o.context=i,o.minLabel=t,o.maxLabel=a,o.labelClass=n,o.dimension=r,o.logarithmic=s,o.labelsSize=o.getMinAndMaxLabelSize(),l?(o.getNiceInterval=o.getNiceIntervalInteger,o.getPossibleBiggerLabel=o.getPossibleBiggerLabelInteger):(o.getNiceInterval=o.getNiceIntervalFloatingPoint,o.getPossibleBiggerLabel=o.getPossibleBiggerLabelFloatingPoint)}return _createClass(e,[{key:"getInterval",value:function(e,i,t,a){function n(){var e=2*Math.PI*l*(Math.abs(r.startAngle-r.endAngle)/360);return Math.round(e)}var r=this.context,l=r._measurements.innerRadius,s=Math.max(this.labelsSize.minLabelSize,this.labelsSize.maxLabelSize),o=1;if("radial"===e){var g=void 0;g=50>l?.3:150>l?.6:250>l?.7:1,o=8/Math.max(1,Math.log10(l))*g}s*=o;var b=void 0;b="radial"===e?n():r[this.dimension]-this.labelsSize.minLabelSize/2-this.labelsSize.maxLabelSize/2;var h=Math.ceil(b/(1.45*s)),m="radial"===e?4*h:3*h,c=this.getNiceInterval(i,t,h,!0),u=this.getNiceInterval(i,t,m);if(h>2){var v=this.getPossibleBiggerLabel(h,c);if(v.length>Math.max(this.minLabel.length,this.maxLabel.length)){var d=this.minLabel;this.minLabel=v,this.labelsSize=this.getMinAndMaxLabelSize();var f=this.getInterval(e,i,t,a);return this.minLabel=d,this.labelsSize=this.getMinAndMaxLabelSize(),f}}return{major:c,minor:u}}},{key:"getNiceIntervalFloatingPoint",value:function(e,i,t,a){var n=i-e,r=Math.floor(Math.log10(n)-Math.log10(t)),l=Math.pow(10,r),s=t*l,o=void 0;o=2*s>n?1:3*s>n?2:7*s>n?5:10;var g=o*l;if(a&&this.context._range/g>t){switch(o){case 5:o=10;break;case 2:o=5;break;case 1:o=2}g=o*l}return this.nearestPowerOfTen=l,this.logarithmic&&a?Math.max(1,g):g}},{key:"getPossibleBiggerLabelFloatingPoint",value:function(e,i){var t=this.context,a=parseFloat(t.min-t._numericProcessor.getPreciseModulo(parseFloat(t.min),i)+parseFloat(i)),n=a,r=void 0,l=void 0;this.logarithmic&&(a=Math.pow(10,a)),r=t._formatLabel(a);for(var s=1;e>s;s++)n+=i,l=this.logarithmic?Math.pow(10,n):n,l=t._formatLabel(l),l.length>r.length&&(r=l);return r}},{key:"getNiceIntervalInteger",value:function(e,i,t,a){var n=new BigNumber(i).subtract(new BigNumber(e)),r=Math.floor(Math.log10(n.toString())-Math.log10(t)),l=new BigNumber(10).pow(new BigNumber(r)),s=new BigNumber(t).multiply(l),o=void 0;o=-1===n.compare(new BigNumber(2*s))?1:-1===n.compare(new BigNumber(3*s))?2:-1===n.compare(new BigNumber(7*s))?5:10;var g=new BigNumber(o).multiply(l);if(a&&1===new BigNumber(this.context._range).divide(g).compare(t)){switch(o){case 5:o=10;break;case 2:o=5;break;case 1:o=2}g=new BigNumber(o).multiply(l)}return-1===g.compare(1)&&(g=new BigNumber(1)),this.nearestPowerOfTen=l,g}},{key:"getPossibleBiggerLabelInteger",value:function(e,i){var t=this.context,a=new BigNumber(10),n=new BigNumber(t.min).subtract(new BigNumber(t.min).mod(i)).add(i),r=n,l=void 0,s=void 0;this.logarithmic&&(n=a.pow(n)),l=t._formatLabel(n);for(var o=1;e>o;o++)r=r.add(i),s=this.logarithmic?a.pow(r):r,s=t._formatLabel(s),s.length>l.length&&(l=s);return l}},{key:"getMinAndMaxLabelSize",value:function(){var e=this,i=e.context,t=i.$.container,a=document.createElement("span");a.className=e.labelClass,a.style.position="absolute",a.style.visibility="hidden",t.appendChild(a),a.innerHTML=e.minLabel;var n=a[e.dimension],r=a[i._settings.otherSize];a.innerHTML=e.maxLabel;var l=a[e.dimension],s=a[i._settings.otherSize];return t.removeChild(a),{minLabelSize:n,minLabelOtherSize:r,maxLabelSize:l,maxLabelOtherSize:s}}}]),e}());